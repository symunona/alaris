(function(){"use strict";var Oe=document.createElement("style");Oe.textContent=`#weeks{padding:12px}.weeks-grid{display:grid;grid-auto-rows:min-content;gap:6px}.decade-group{display:grid;gap:6px;padding:6px 0 10px;border-bottom:1px solid #e5e7eb}.decade-header{font-weight:600;color:#374151;font-size:12px;letter-spacing:.02em}.weeks-header{display:grid;grid-template-columns:40px repeat(52,16px);gap:4px;align-items:end;margin-bottom:10px}.year-head-spacer{width:40px}.week-head{width:16px;font-size:9px;color:#6b7280;text-align:center;line-height:1}.year-row{display:grid;grid-template-columns:40px repeat(52,16px) 40px;gap:4px;align-items:center;position:relative;margin-top:50px}.year-row{display:grid;grid-template-columns:40px repeat(52,16px) 40px;gap:4px;align-items:center;position:relative}.year-edge{width:40px;height:16px;border-radius:4px}.year-row:before{content:none}.year-head{width:40px;font-size:11px;color:#4b5563;text-align:right;padding-right:4px}.week-box{width:16px;height:16px;background:transparent;border:1px solid #cbd5e1;border-radius:0;box-shadow:none}.week-box:hover{border-color:#5b9bd5;outline:none}.week-box.before-my-time{background:transparent;border-color:#f8f9fb!important}.week-box.before-my-time:hover{outline:none}.week-box.future{opacity:.2}.week-box.selected{outline:2px solid #2563eb;background:#dbeafe}.week-box.filled{background:#ededed;border-color:#60a5fa;position:relative}.week-box.season-winter{border-color:#9ca3af}.week-box.season-spring{border-color:#86efac}.week-box.season-summer{border-color:#fbbf24}.week-box.season-autumn{border-color:#ef4444}.week-box.season-winter:hover{border-color:#4b5563}.week-box.season-spring:hover{border-color:#16a34a}.week-box.season-summer:hover{border-color:#a16207}.week-box.season-autumn:hover{border-color:#b91c1c}.tag-bars{display:grid;grid-template-columns:40px 1fr 40px;gap:4px;margin:4px 0 10px}.tag-edge{width:40px;border-radius:4px}.tag-lines{display:flex;flex-direction:column;gap:2px;position:relative;--week: 16px;--gap: 4px;background-image:none;border-radius:4px}.tag-row{position:relative;height:16px;width:calc(52 * var(--week) + (52 - 1) * var(--gap))}.tag-cell{width:16px;height:16px;border:1px solid transparent;border-radius:0;position:relative;overflow:hidden}.tag-span{position:absolute;top:0;left:var(--left, calc(var(--x) * (var(--week) + var(--gap))));width:var(--width, calc(var(--w) * var(--week) + (var(--w) - 1) * var(--gap)));height:16px;border:1px solid transparent;border-radius:2px}.tag-span.edited{box-shadow:0 0 0 2px #22c55e inset,0 0 0 1px #16a34a;border-color:#16a34a!important}.tag-label{position:absolute;left:2px;right:2px;top:0;bottom:0;font-size:9px;line-height:16px;color:#111827;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;pointer-events:none}.tag-hover{display:none;position:absolute;left:0;top:18px;z-index:20;max-width:300px;width:max-content;background:#ffffff;border:1px solid #e5e7eb;border-radius:6px;box-shadow:0 10px 20px #00000014,0 6px 6px #0000000f;padding:8px}.tag-span:hover .tag-hover{display:block}.tag-hover-fields{display:grid;grid-template-columns:1fr;gap:6px}.tag-hover-fields label{display:grid;gap:2px;font-size:11px;color:#374151}.tag-hover-fields input,.tag-hover-fields textarea{width:100%;box-sizing:border-box;padding:6px 8px;border:1px solid #d1d5db;border-radius:4px;background:#f9fafb;color:#111827;font-size:12px}.tag-hover-fields textarea{resize:vertical}.tag-hover-image{margin-top:8px;border:1px solid #e5e7eb;border-radius:4px;overflow:hidden}.tag-hover-image img{display:block;width:100%;height:auto}.event-hover{display:none;position:absolute;left:0;top:18px;z-index:20;max-width:280px;width:max-content;background:#ffffff;border:1px solid #e5e7eb;border-radius:6px;box-shadow:0 10px 20px #00000014,0 6px 6px #0000000f;padding:8px}.week-box:hover .event-hover{display:block}.event-hover-title{font-weight:600;font-size:12px;margin-bottom:6px;color:#111827}.event-hover-list{margin:0;padding:0;list-style:none;display:grid;gap:4px}.event-hover-list li{font-size:12px;color:#374151;cursor:pointer}.event-hover-list li .event-item-link{display:block;color:inherit;text-decoration:none}.event-hover-list li .event-item-link:hover{text-decoration:underline}.event-date{color:#6b7280;margin-right:6px}.event-name{color:#111827;font-weight:500}.event-desc{font-size:11px;color:#4b5563}.event-more{margin-top:6px;font-size:11px;color:#6b7280}.week-event-tooltip{position:fixed;z-index:99999;transform:translateY(6px);pointer-events:auto}.week-event-tooltip .event-hover{display:block!important;position:static;pointer-events:auto}.events-track{display:grid;grid-template-columns:40px 1fr 40px;gap:4px;margin:0 0 8px}.events-pins{position:relative;--week: 16px;--gap: 4px;height:18px;width:calc(52 * var(--week) + (52 - 1) * var(--gap))}.event-pin{position:absolute;left:calc((var(--x) - .65) * (var(--week) + (var(--gap))));top:0;display:flex;align-items:flex-end;color:inherit;text-decoration:none}.event-pin .stem{display:inline-block;width:2px;height:12px;background:#9ca3af;position:relative}.event-pin .stem:after{content:"";position:absolute;left:50%;bottom:-2px;width:6px;height:6px;background:#374151;border-radius:9999px;transform:translate(-50%)}.event-pin .elabel{margin-left:6px;font-size:12px;color:#111827;white-space:nowrap;line-height:1}.events-list{--week: 16px;--gap: 4px;display:grid;grid-template-columns:40px calc(52 * var(--week) + (52 - 1) * var(--gap)) 40px;gap:4px;margin:2px 0 8px}.events-line{width:100%;display:flex;flex-wrap:wrap;gap:8px 12px;align-items:center}.event-item{display:inline-flex;align-items:center;color:inherit;text-decoration:none;font-size:12px}.event-item .dot{width:6px;height:6px;background:#374151;border-radius:9999px;margin-right:6px}.event-item .text{line-height:1;white-space:nowrap}.tag-detail{display:grid;gap:12px;padding:0 12px 12px;position:relative}.back-btn{width:max-content;padding:6px 10px;font-size:12px;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:4px;cursor:pointer}.back-btn:hover{background:#e5e7eb}.tag-title{margin:0;font-size:20px;font-weight:600;color:#111827}.tag-image-wrap{width:100%;max-height:calc(100vh - 180px);overflow:hidden;border-radius:8px;border:1px solid #e5e7eb;background:#f9fafb}.tag-image-wrap.placeholder{display:grid;place-items:center;color:#6b7280;height:240px}.tag-image{display:block;width:100%;height:100%;object-fit:cover}.tag-form{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;align-items:end}.tag-form label{display:grid;gap:4px;font-size:12px;color:#374151}.tag-form input{height:34px;padding:6px 8px;border:1px solid #d1d5db;border-radius:6px;background:#f9fafb;color:#111827}.tag-form input[readonly]{background:#f3f4f6}.tag-actions{display:flex;gap:8px;position:absolute;top:12px;right:12px;white-space:nowrap}.tag-actions>*{flex:0 0 auto}.save-btn{background:#2563eb;border:1px solid #1d4ed8;color:#fff;padding:6px 10px;border-radius:4px;cursor:pointer}.save-btn:hover{background:#1d4ed8}.delete-btn{background:#fee2e2;border:1px solid #fecaca;color:#991b1b;padding:6px 10px;border-radius:4px;cursor:pointer}.delete-btn:hover{background:#fecaca}
`,document.head.appendChild(Oe);const it=!1,at=(e,t)=>e===t,ot=Symbol("solid-track"),me={equals:at};let Pe=ze;const Q=1,xe=2,je={owned:null,cleanups:null,context:null,owner:null};var N=null;let Ie=null,lt=null,A=null,P=null,G=null,ve=0;function we(e,t){const n=A,s=N,a=e.length===0,i=t===void 0?s:t,l=a?je:{owned:null,cleanups:null,context:i?i.context:null,owner:i},r=a?e:()=>e(()=>X(()=>ge(l)));N=l,A=null;try{return pe(r,!0)}finally{A=n,N=s}}function Y(e,t){t=t?Object.assign({},me,t):me;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=a=>(typeof a=="function"&&(a=a(n.value)),Ue(n,a));return[Fe.bind(n),s]}function E(e,t,n){const s=Ae(e,t,!1,Q);fe(s)}function We(e,t,n){Pe=pt;const s=Ae(e,t,!1,Q);(!n||!n.render)&&(s.user=!0),G?G.push(s):fe(s)}function K(e,t,n){n=n?Object.assign({},me,n):me;const s=Ae(e,t,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,fe(s),Fe.bind(s)}function X(e){if(A===null)return e();const t=A;A=null;try{return e()}finally{A=t}}function ct(e){We(()=>X(e))}function dt(e){return N===null||(N.cleanups===null?N.cleanups=[e]:N.cleanups.push(e)),e}function Fe(){if(this.sources&&this.state)if(this.state===Q)fe(this);else{const e=P;P=null,pe(()=>$e(this),!1),P=e}if(A){const e=this.observers?this.observers.length:0;A.sources?(A.sources.push(this),A.sourceSlots.push(e)):(A.sources=[this],A.sourceSlots=[e]),this.observers?(this.observers.push(A),this.observerSlots.push(A.sources.length-1)):(this.observers=[A],this.observerSlots=[A.sources.length-1])}return this.value}function Ue(e,t,n){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&pe(()=>{for(let a=0;a<e.observers.length;a+=1){const i=e.observers[a],l=Ie&&Ie.running;l&&Ie.disposed.has(i),(l?!i.tState:!i.state)&&(i.pure?P.push(i):G.push(i),i.observers&&Ve(i)),l||(i.state=Q)}if(P.length>1e6)throw P=[],new Error},!1)),t}function fe(e){if(!e.fn)return;ge(e);const t=ve;ut(e,e.value,t)}function ut(e,t,n){let s;const a=N,i=A;A=N=e;try{s=e.fn(t)}catch(l){return e.pure&&(e.state=Q,e.owned&&e.owned.forEach(ge),e.owned=null),e.updatedAt=n+1,He(l)}finally{A=i,N=a}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?Ue(e,s):e.value=s,e.updatedAt=n)}function Ae(e,t,n,s=Q,a){const i={fn:e,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:N,context:N?N.context:null,pure:n};return N===null||N!==je&&(N.owned?N.owned.push(i):N.owned=[i]),i}function ye(e){if(e.state===0)return;if(e.state===xe)return $e(e);if(e.suspense&&X(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<ve);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===Q)fe(e);else if(e.state===xe){const s=P;P=null,pe(()=>$e(e,t[0]),!1),P=s}}function pe(e,t){if(P)return e();let n=!1;t||(P=[]),G?n=!0:G=[],ve++;try{const s=e();return ft(n),s}catch(s){n||(G=null),P=null,He(s)}}function ft(e){if(P&&(ze(P),P=null),e)return;const t=G;G=null,t.length&&pe(()=>Pe(t),!1)}function ze(e){for(let t=0;t<e.length;t++)ye(e[t])}function pt(e){let t,n=0;for(t=0;t<e.length;t++){const s=e[t];s.user?e[n++]=s:ye(s)}for(t=0;t<n;t++)ye(e[t])}function $e(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];if(s.sources){const a=s.state;a===Q?s!==t&&(!s.updatedAt||s.updatedAt<ve)&&ye(s):a===xe&&$e(s,t)}}}function Ve(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=xe,n.pure?P.push(n):G.push(n),n.observers&&Ve(n))}}function ge(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),s=e.sourceSlots.pop(),a=n.observers;if(a&&a.length){const i=a.pop(),l=n.observerSlots.pop();s<a.length&&(i.sourceSlots[l]=s,a[s]=i,n.observerSlots[s]=l)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)ge(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)ge(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function gt(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function He(e,t=N){throw gt(e)}const ht=Symbol("fallback");function Ke(e){for(let t=0;t<e.length;t++)e[t]()}function bt(e,t,n={}){let s=[],a=[],i=[],l=0,r=t.length>1?[]:null;return dt(()=>Ke(i)),()=>{let c=e()||[],f=c.length,u,d;return c[ot],X(()=>{let p,x,w,b,$,k,T,C,I;if(f===0)l!==0&&(Ke(i),i=[],s=[],a=[],l=0,r&&(r=[])),n.fallback&&(s=[ht],a[0]=we(j=>(i[0]=j,n.fallback())),l=1);else if(l===0){for(a=new Array(f),d=0;d<f;d++)s[d]=c[d],a[d]=we(o);l=f}else{for(w=new Array(f),b=new Array(f),r&&($=new Array(f)),k=0,T=Math.min(l,f);k<T&&s[k]===c[k];k++);for(T=l-1,C=f-1;T>=k&&C>=k&&s[T]===c[C];T--,C--)w[C]=a[T],b[C]=i[T],r&&($[C]=r[T]);for(p=new Map,x=new Array(C+1),d=C;d>=k;d--)I=c[d],u=p.get(I),x[d]=u===void 0?-1:u,p.set(I,d);for(u=k;u<=T;u++)I=s[u],d=p.get(I),d!==void 0&&d!==-1?(w[d]=a[u],b[d]=i[u],r&&($[d]=r[u]),d=x[d],p.set(I,d)):i[u]();for(d=k;d<f;d++)d in w?(a[d]=w[d],i[d]=b[d],r&&(r[d]=$[d],r[d](d))):a[d]=we(o);a=a.slice(0,l=f),s=c.slice(0)}return a});function o(p){if(i[d]=p,r){const[x,w]=Y(d);return r[d]=w,t(c[d],x)}return t(c[d])}}}function O(e,t){return X(()=>e(t||{}))}const mt=e=>`Stale read from <${e}>.`;function Z(e){const t="fallback"in e&&{fallback:()=>e.fallback};return K(bt(()=>e.each,e.children,t||void 0))}function xt(e){const t=e.keyed,n=K(()=>e.when,void 0,void 0),s=t?n:K(n,void 0,{equals:(a,i)=>!a==!i});return K(()=>{const a=s();if(a){const i=e.children;return typeof i=="function"&&i.length>0?X(()=>i(t?a:()=>{if(!X(s))throw mt("Show");return n()})):i}return e.fallback},void 0,void 0)}const U=e=>K(()=>e());function vt(e,t,n){let s=n.length,a=t.length,i=s,l=0,r=0,c=t[a-1].nextSibling,f=null;for(;l<a||r<i;){if(t[l]===n[r]){l++,r++;continue}for(;t[a-1]===n[i-1];)a--,i--;if(a===l){const u=i<s?r?n[r-1].nextSibling:n[i-r]:c;for(;r<i;)e.insertBefore(n[r++],u)}else if(i===r)for(;l<a;)(!f||!f.has(t[l]))&&t[l].remove(),l++;else if(t[l]===n[i-1]&&n[r]===t[a-1]){const u=t[--a].nextSibling;e.insertBefore(n[r++],t[l++].nextSibling),e.insertBefore(n[--i],u),t[a]=n[i]}else{if(!f){f=new Map;let d=r;for(;d<i;)f.set(n[d],d++)}const u=f.get(t[l]);if(u!=null)if(r<u&&u<i){let d=l,o=1,p;for(;++d<a&&d<i&&!((p=f.get(t[d]))==null||p!==u+o);)o++;if(o>u-r){const x=t[l];for(;r<u;)e.insertBefore(n[r++],x)}else e.replaceChild(n[r++],t[l++])}else l++;else t[l++].remove()}}}const Re="_$DX_DELEGATE";function wt(e,t,n,s={}){let a;return we(i=>{a=i,t===document?e():_(t,e(),t.firstChild?null:void 0,n)},s.owner),()=>{a(),t.textContent=""}}function D(e,t,n,s){let a;const i=()=>{const r=s?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return r.innerHTML=e,n?r.content.firstChild.firstChild:s?r.firstChild:r.content.firstChild},l=t?()=>X(()=>document.importNode(a||(a=i()),!0)):()=>(a||(a=i())).cloneNode(!0);return l.cloneNode=l,l}function Be(e,t=window.document){const n=t[Re]||(t[Re]=new Set);for(let s=0,a=e.length;s<a;s++){const i=e[s];n.has(i)||(n.add(i),t.addEventListener(i,yt))}}function z(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function Me(e,t){t==null?e.removeAttribute("class"):e.className=t}function qe(e,t,n){if(!t)return n?z(e,"style"):t;const s=e.style;if(typeof t=="string")return s.cssText=t;typeof n=="string"&&(s.cssText=n=void 0),n||(n={}),t||(t={});let a,i;for(i in n)t[i]==null&&s.removeProperty(i),delete n[i];for(i in t)a=t[i],a!==n[i]&&(s.setProperty(i,a),n[i]=a);return n}function Ge(e,t,n){n!=null?e.style.setProperty(t,n):e.style.removeProperty(t)}function _(e,t,n,s){if(n!==void 0&&!s&&(s=[]),typeof t!="function")return ke(e,t,s,n);E(a=>ke(e,t(),a,n),s)}function yt(e){let t=e.target;const n=`$$${e.type}`,s=e.target,a=e.currentTarget,i=c=>Object.defineProperty(e,"target",{configurable:!0,value:c}),l=()=>{const c=t[n];if(c&&!t.disabled){const f=t[`${n}Data`];if(f!==void 0?c.call(t,f,e):c.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&i(t.host),!0},r=()=>{for(;l()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const c=e.composedPath();i(c[0]);for(let f=0;f<c.length-2&&(t=c[f],!!l());f++){if(t._$host){t=t._$host,r();break}if(t.parentNode===a)break}}else r();i(s)}function ke(e,t,n,s,a){for(;typeof n=="function";)n=n();if(t===n)return n;const i=typeof t,l=s!==void 0;if(e=l&&n[0]&&n[0].parentNode||e,i==="string"||i==="number"){if(i==="number"&&(t=t.toString(),t===n))return n;if(l){let r=n[0];r&&r.nodeType===3?r.data!==t&&(r.data=t):r=document.createTextNode(t),n=ce(e,n,s,r)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||i==="boolean")n=ce(e,n,s);else{if(i==="function")return E(()=>{let r=t();for(;typeof r=="function";)r=r();n=ke(e,r,n,s)}),()=>n;if(Array.isArray(t)){const r=[],c=n&&Array.isArray(n);if(Ne(r,t,n,a))return E(()=>n=ke(e,r,n,s,!0)),()=>n;if(r.length===0){if(n=ce(e,n,s),l)return n}else c?n.length===0?Je(e,r,s):vt(e,n,r):(n&&ce(e),Je(e,r));n=r}else if(t.nodeType){if(Array.isArray(n)){if(l)return n=ce(e,n,s,t);ce(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Ne(e,t,n,s){let a=!1;for(let i=0,l=t.length;i<l;i++){let r=t[i],c=n&&n[e.length],f;if(!(r==null||r===!0||r===!1))if((f=typeof r)=="object"&&r.nodeType)e.push(r);else if(Array.isArray(r))a=Ne(e,r,c)||a;else if(f==="function")if(s){for(;typeof r=="function";)r=r();a=Ne(e,Array.isArray(r)?r:[r],Array.isArray(c)?c:[c])||a}else e.push(r),a=!0;else{const u=String(r);c&&c.nodeType===3&&c.data===u?e.push(c):e.push(document.createTextNode(u))}}return a}function Je(e,t,n=null){for(let s=0,a=t.length;s<a;s++)e.insertBefore(t[s],n)}function ce(e,t,n,s){if(n===void 0)return e.textContent="";const a=s||document.createTextNode("");if(t.length){let i=!1;for(let l=t.length-1;l>=0;l--){const r=t[l];if(a!==r){const c=r.parentNode===e;!i&&!l?c?e.replaceChild(a,r):e.insertBefore(a,n):c&&r.remove()}else i=!0}}else e.insertBefore(a,n);return[a]}var $t=D('<div class=tag-detail><div style=display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:8px><button class=back-btn>← Back</button><button class=save-btn style=margin-left:auto>Save</button><button class=delete-btn>Delete</button></div><h2 class=tag-title></h2><div class=tag-form><label><span>ID</span><input type=text readonly></label><label><span>Name</span><input type=text></label><label><span>Start date</span><input type=date></label><label><span>End date</span><input type=date></label><label><span>Image</span><input type=text></label><label><span>Place</span><input type=text></label><label style="grid-column:1 / -1"><span>Description</span><textarea rows=6>'),kt=D("<div class=tag-image-wrap><img class=tag-image>"),St=D('<div class="tag-image-wrap placeholder">No image');function Qe(e){const t=()=>e.tag||{},[n,s]=Y({id:t().id,name:t().name||"",startdate:e.prefill&&e.prefill.startdate||(t().startdate?new Date(t().startdate).toISOString().slice(0,10):""),enddate:e.prefill&&e.prefill.enddate||(t().enddate?new Date(t().enddate).toISOString().slice(0,10):""),background:t().background||"",description:t().description||"",place:t().place||""}),a=r=>{const c=r?new Date(r):null;return!c||isNaN(c.getTime())?null:c.toISOString().slice(0,10)},i=async()=>{const r=n(),c={id:r.id,name:r.name,startdate:a(r.startdate),enddate:a(r.enddate),background:r.background,description:r.description,place:r.place},u=await(await fetch("/api/tag/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json();e.onSave(u),s({id:u.id,name:u.name||"",startdate:u.startdate?new Date(u.startdate).toISOString().slice(0,10):"",enddate:u.enddate?new Date(u.enddate).toISOString().slice(0,10):"",background:u.background||"",description:u.description||"",place:u.place||""})},l=async()=>{const r=n().id;if(!r||!confirm("Delete this tag? This cannot be undone."))return;(await fetch(`/api/tag/delete/${r}`,{method:"DELETE"})).ok&&e.onDelete(r)};return(()=>{var r=$t(),c=r.firstChild,f=c.firstChild,u=f.nextSibling,d=u.nextSibling,o=c.nextSibling,p=o.nextSibling,x=p.firstChild,w=x.firstChild,b=w.nextSibling,$=x.nextSibling,k=$.firstChild,T=k.nextSibling,C=$.nextSibling,I=C.firstChild,j=I.nextSibling,R=C.nextSibling,B=R.firstChild,q=B.nextSibling,F=R.nextSibling,V=F.firstChild,ee=V.nextSibling,Te=F.nextSibling,se=Te.firstChild,re=se.nextSibling,ie=Te.nextSibling,Ye=ie.firstChild,te=Ye.nextSibling;return f.$$click=()=>{try{e.onBack&&e.onBack(t().id)}catch{}history.length>1?history.back():window.location.hash=""},u.$$click=i,d.$$click=l,_(o,()=>{var L;return((L=t())==null?void 0:L.name)??"Tag"}),T.$$input=L=>s({...n(),name:L.currentTarget.value}),j.$$input=L=>s({...n(),startdate:L.currentTarget.value}),q.$$input=L=>s({...n(),enddate:L.currentTarget.value}),ee.$$input=L=>s({...n(),background:L.currentTarget.value}),re.$$input=L=>s({...n(),place:L.currentTarget.value}),te.$$input=L=>s({...n(),description:L.currentTarget.value}),_(r,(()=>{var L=U(()=>{var ae;return!!((ae=t())!=null&&ae.background)});return()=>L()?(()=>{var ae=kt(),De=ae.firstChild;return E(oe=>{var m;var ne=t().background,h=((m=t())==null?void 0:m.name)??"Tag image";return ne!==oe.e&&z(De,"src",oe.e=ne),h!==oe.t&&z(De,"alt",oe.t=h),oe},{e:void 0,t:void 0}),ae})():St()})(),null),E(()=>b.value=n().id??""),E(()=>T.value=n().name),E(()=>j.value=n().startdate),E(()=>q.value=n().enddate),E(()=>ee.value=n().background),E(()=>re.value=n().place),E(()=>te.value=n().description),r})()}Be(["click","input"]);var _t=D('<div class=tag-detail><div style=display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:8px><button class=back-btn>← Back</button><button class=save-btn style=margin-left:auto>Save</button><button class=delete-btn>Delete</button></div><h2 class=tag-title></h2><div class=tag-form><label><span>ID</span><input type=text readonly></label><label><span>Date</span><input type=date></label><label><span>Name</span><input type=text></label><label style="grid-column:1 / -1"><span>Description</span><textarea rows=6>');function Xe(e){const t=()=>e.event||{},[n,s]=Y({id:t().id,date:e.prefill&&e.prefill.date||(t().date?new Date(t().date).toISOString().slice(0,10):""),name:t().name||"",description:t().description||""}),a=r=>{const c=r?new Date(r):null;return!c||isNaN(c.getTime())?null:c.toISOString().slice(0,10)},i=async()=>{const r=n(),c={id:r.id,date:a(r.date),name:r.name,description:r.description||""},u=await(await fetch("/api/event/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json();e.onSave(u),s({id:u.id,date:u.date?new Date(u.date).toISOString().slice(0,10):"",name:u.name||"",description:u.description||""})},l=async()=>{const r=n().id;if(!r||!confirm("Delete this event? This cannot be undone."))return;(await fetch(`/api/event/delete/${r}`,{method:"DELETE"})).ok&&e.onDelete(r)};return(()=>{var r=_t(),c=r.firstChild,f=c.firstChild,u=f.nextSibling,d=u.nextSibling,o=c.nextSibling,p=o.nextSibling,x=p.firstChild,w=x.firstChild,b=w.nextSibling,$=x.nextSibling,k=$.firstChild,T=k.nextSibling,C=$.nextSibling,I=C.firstChild,j=I.nextSibling,R=C.nextSibling,B=R.firstChild,q=B.nextSibling;return f.$$click=()=>{try{e.onBack&&e.onBack(t().id)}catch{}history.length>1?history.back():window.location.hash=""},u.$$click=i,d.$$click=l,_(o,(()=>{var F=U(()=>{var V;return!!((V=t())!=null&&V.name)});return()=>{var V;return F()?`Event: ${(V=t())==null?void 0:V.name}`:"Event"}})()),T.$$input=F=>s({...n(),date:F.currentTarget.value}),j.$$input=F=>s({...n(),name:F.currentTarget.value}),q.$$input=F=>s({...n(),description:F.currentTarget.value}),E(()=>b.value=n().id??""),E(()=>T.value=n().date),E(()=>j.value=n().name),E(()=>q.value=n().description||""),r})()}Be(["click","input"]);function Tt(e,t){const n=new Date(e);return n.setDate(n.getDate()+t),n}function Le(...e){const t=[],n=s=>{if(s){if(typeof s=="string")t.push(s);else if(Array.isArray(s))s.forEach(n);else if(typeof s=="object")for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&t.push(a)}};return e.forEach(n),t.join(" ")}function Ze(e){const t=new Date(e),n=t.getDay(),s=(n===0?-6:1)-n;return t.setDate(t.getDate()+s),t.setHours(0,0,0,0),t}function Dt(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),n=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-n);const s=new Date(Date.UTC(t.getUTCFullYear(),0,1)),a=Math.ceil(((t.getTime()-s.getTime())/864e5+1)/7);return{isoYear:t.getUTCFullYear(),isoWeek:a}}function et(e){const{isoYear:t,isoWeek:n}=Dt(e),s=n.toString().padStart(2,"0");return`${t}-${s}`}function Ct(e){const t={};for(const n of Object.keys(e)){const s=parseInt(n,10),a=e[s].sort((l,r)=>(r.length||0)-(l.length||0)),i=[];for(const l of a){let r=0;for(;r<i.length;){const c=i[r];let f=!1;for(const u of c)if(l.startWeek<u.endWeek&&l.endWeek>u.startWeek){f=!0;break}if(!f)break;r++}r===i.length&&i.push([]),i[r].push(l)}for(const l of i)l.sort((r,c)=>r.startWeek-c.startWeek);t[s]=i}return t}function Et(e,t){const{startDate:n,baseYearLabel:s,years:a}=t,i={};for(const o of e)o&&o.id!=null&&(i[o.id]=o);const l=e.map(o=>{const p=o.startdate?new Date(o.startdate):null,x=o.enddate?new Date(o.enddate):null,w={};if(p){let b=Ze(p);const $=x||p;for(;b<=$;)w[et(b)]=!0,b=Tt(b,7)}return{id:o.id??null,name:o.name??null,start:p,end:x,weekMap:w,startdate:o.startdate,enddate:o.enddate,place:o.place}}),r=[];for(let o=0;o<a;o++){const p=s+o,x=new Date(p,0,1);r.push({labelYear:p,firstDate:x,pad:0})}const c=Object.create(null);for(const o of r)c[o.labelYear]=o;function f(o){return 52}function u(o,p){const x=c[p];if(!x)return 1;const w=Math.floor((+o-+x.firstDate)/(1e3*60*60*24)),b=Math.floor(w/7)+1;return Math.max(1,Math.min(52,b))}const d={};for(const o of l){const p=o.start instanceof Date&&!isNaN(o.start.getTime()),x=o.end instanceof Date&&!isNaN(o.end.getTime());if(p&&o.start){const w=o.start,b=w.getFullYear(),$=u(w,b),k=x&&o.end&&o.end.getFullYear()===b?u(o.end,b):f();(d[b]=d[b]||[]).push({id:o.id,name:o.name,startWeek:$,endWeek:k,length:k-$+1,startdate:o.startdate,enddate:o.enddate,place:o.place})}if(x&&o.end){const w=o.end,b=w.getFullYear();if(!p||!o.start||b!==o.start.getFullYear()){const k=u(w,b);(d[b]=d[b]||[]).push({id:o.id,name:o.name,startWeek:1,endWeek:k,length:k-1+1,startdate:o.startdate,enddate:o.enddate,place:o.place})}}if(p&&x&&o.start&&o.end){const w=o.start.getFullYear(),b=o.end.getFullYear();if(b-w>=2)for(let $=w+1;$<=b-1;$++){const T=f();(d[$]=d[$]||[]).push({id:o.id,name:o.name,startWeek:1,endWeek:T,length:T-1+1,startdate:o.startdate,enddate:o.enddate,place:o.place})}}}return{yearMap:d,tagById:i,tagsList:e,yearSlotMap:Ct(d)}}function he(e){const t={},n={};for(const s of e||[]){const a=s.date?new Date(s.date):null;if(!a||isNaN(a.getTime()))continue;const i=et(Ze(a));(t[i]=t[i]||[]).push(s),s.id!=null&&(n[s.id]=s)}return{eventsByWeek:t,eventById:n,eventsList:e||[]}}const pn="";var It=D("<div class=events-track><div class=year-head></div><div class=events-pins></div><div class=year-edge>"),Wt=D("<div class=event-pin>"),At=D("<a><span class=stem></span><span class=elabel>"),Bt=D("<div class=tag-bars><div class=year-head></div><div class=tag-lines></div><div class=tag-edge>"),Mt=D("<div class=tag-row>"),Nt=D("<div><span class=tag-label> "),Lt=D("<div class=tag-hover><div class=tag-hover-title></div><div class=tag-hover-dates><span></span><span> – </span><span>"),Yt=D("<div class=tag-hover-place>"),Ot=D("<div class=tag-hover-desc>"),Pt=D("<div class=tag-hover-image><img>"),jt=D("<div class=tag-hover-posts>"),Ft=D("<div class=tag-hover-loading>Loading posts…"),Ut=D("<div class=tag-hover-error>Failed to load posts."),zt=D("<div class=tag-hover-posts><div class=tag-hover-posts-title>Posts: </div><ul>"),Vt=D("<li>"),Ht=D("<div class=tag-hover-more>and <!> more…"),Kt=D("<div class=tag-hover-none>No posts"),Rt=D("<div class=weeks-grid>"),qt=D("<div class=decade-group><div class=decade-header></div><div class=weeks-header aria-hidden=true><div class=year-head-spacer>"),Gt=D("<div class=week-head>"),Jt=D("<div class=year-row><div class=year-head></div><div class=year-edge>"),Qt=D("<div>");function Xt(e,t){const n=new Date(e);return n.setDate(n.getDate()+t),n}function Zt(e){return e.toISOString().slice(0,10)}function en(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),n=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-n);const s=new Date(Date.UTC(t.getUTCFullYear(),0,1)),a=Math.ceil(((t.getTime()-s.getTime())/864e5+1)/7);return{isoYear:t.getUTCFullYear(),isoWeek:a}}function tt(e){const{isoYear:t,isoWeek:n}=en(e),s=n.toString().padStart(2,"0");return`${t}-${s}`}function Se(e){const t=new Date(e),n=t.getDay(),s=(n===0?-6:1)-n;return t.setDate(t.getDate()+s),t.setHours(0,0,0,0),t}function tn(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Math.abs(t)}function nn(e){const t=e%360,n=`hsla(${t} 60% 86% / 0.45)`,s=`hsla(${t} 50% 50% / 0.7)`;return{bg:n,border:s}}function sn(e){const t=(e.id!=null?String(e.id):"")+"|"+(e.name!=null?String(e.name):"");return nn(tn(t))}function _e(e){const t=e.replace("#",""),n=parseInt(t.length===3?t.split("").map(s=>s+s).join(""):t,16);return{r:n>>16&255,g:n>>8&255,b:n&255}}function be(e,t,n){return{r:Math.round(e.r+(t.r-e.r)*n),g:Math.round(e.g+(t.g-e.g)*n),b:Math.round(e.b+(t.b-e.b)*n)}}function nt(e,t){return`rgba(${e.r}, ${e.g}, ${e.b}, ${t})`}function st(e,t,n){const s=Math.min(90,n),a=Math.max(0,Math.min(s-1,e-t)),i=s/4,l=Math.min(3,Math.floor(a/i)),r=Math.min(1,Math.max(0,(a-l*i)/Math.max(1,i-1))),c=_e("#86efac"),f=_e("#fbbf24"),u=_e("#ef4444"),d=_e("#9ca3af");let o,p;l===0?(o=c,p=be(c,f,.5)):l===1?(o=f,p=be(f,u,.5)):l===2?(o=u,p=be(u,d,.5)):(o=d,p=be(d,c,.5));const x=.1,w=.12,b=nt(o,x),$=nt(be(o,p,r),w);return`linear-gradient(90deg, ${b} 0%, ${$} 100%)`}function rn(e){return(()=>{var t=It(),n=t.firstChild,s=n.nextSibling;return _(s,O(xt,{get when(){return Object.keys(e.getEventsByWeek()||{}).length>0},get children(){return O(Z,{get each(){return e.weeks},children:(a,i)=>{const l=tt(Se(a.start)),r=e.getEventsByWeek()[l]||[];return!r||r.length===0?null:(()=>{var c=Wt();return _(c,O(Z,{each:r,children:f=>(()=>{var u=At(),d=u.firstChild,o=d.nextSibling;return _(o,()=>f.name),E(p=>{var x=Le("event-entry",{edited:e.getLastEditedEventId()===f.id}),w=f.id,b=`#events/${f.id}`,$=f.description||f.name;return x!==p.e&&Me(u,p.e=x),w!==p.t&&z(u,"data-id",p.t=w),b!==p.a&&z(u,"href",p.a=b),$!==p.o&&z(u,"title",p.o=$),p},{e:void 0,t:void 0,a:void 0,o:void 0}),u})()})),E(f=>qe(c,`--x: ${i()+1};`,f)),c})()}})}})),t})()}function an(e){return(()=>{var t=Bt(),n=t.firstChild,s=n.nextSibling,a=s.nextSibling;return _(s,O(Z,{get each(){return e.lanes||[]},children:i=>(()=>{var l=Mt();return _(l,O(Z,{each:i,children:r=>{const c=sn(r),f=e.pad+r.startWeek,u=e.pad+r.endWeek,d=()=>{r.id!=null&&(window.location.hash=`#tags/${r.id}`)},o=new Date(e.labelYear,0,1).getTime(),p=new Date(e.labelYear+1,0,1).getTime(),x=r.startdate?new Date(r.startdate).getTime():o,w=r.enddate?new Date(r.enddate).getTime():x,b=Math.max(o,x),$=Math.min(p,w),k=Math.max(1,p-o),T=Math.max(0,(b-o)/k*100),C=Math.max(.5,(Math.max($,b)-b)/k*100);return(()=>{var I=Nt(),j=I.firstChild,R=j.firstChild;return I.addEventListener("mouseenter",()=>e.ensureTagPosts(r.id)),I.$$click=d,_(j,(()=>{var B=U(()=>!!r.place);return()=>B()?r.place+" - ":""})(),R),_(j,()=>r.name,null),_(I,()=>{const B=e.tagById()[r.id]||{};return O(on,{tag:B})},null),E(B=>{var q=Le("tag-span",{edited:e.lastEditedTagId()===r.id}),F=`--x: ${f-1}; --w: ${u-f+1}; --left: ${T}%; --width: ${C}%; background:${c.bg}; border-color:${c.border}; cursor:pointer;`,V=`${r.name} (W${r.startWeek}–W${r.endWeek})`;return q!==B.e&&Me(I,B.e=q),B.t=qe(I,F,B.t),V!==B.a&&z(I,"title",B.a=V),B},{e:void 0,t:void 0,a:void 0}),I})()}})),l})()})),E(i=>Ge(a,"background",st(e.labelYear,e.baseYearLabel,e.years))),t})()}function on(e){const t=e.tag||{},n=t.startdate?new Date(t.startdate):null,s=t.enddate?new Date(t.enddate):null,a=i=>{if(!i)return"";const l=i instanceof Date?i:new Date(i);return isNaN(l.getTime())?"":l.toISOString().slice(0,10)};return(()=>{var i=Lt(),l=i.firstChild,r=l.nextSibling,c=r.firstChild,f=c.nextSibling,u=f.nextSibling;return _(l,()=>t.name||""),_(c,()=>a(n)),_(u,()=>a(s)),_(i,(()=>{var d=U(()=>!!t.place);return()=>d()?(()=>{var o=Yt();return _(o,()=>t.place),o})():null})(),null),_(i,(()=>{var d=U(()=>!!t.description);return()=>d()?(()=>{var o=Ot();return _(o,()=>t.description),o})():null})(),null),_(i,(()=>{var d=U(()=>!!t.background);return()=>d()?(()=>{var o=Pt(),p=o.firstChild;return E(x=>{var w=t.background,b=t.name||"tag image";return w!==x.e&&z(p,"src",x.e=w),b!==x.t&&z(p,"alt",x.t=b),x},{e:void 0,t:void 0}),o})():null})(),null),_(i,(()=>{var d=U(()=>!!t.postsStatus);return()=>d()?(()=>{var o=jt();return _(o,(()=>{var p=U(()=>t.postsStatus==="loading");return()=>p()?Ft():U(()=>t.postsStatus==="error")()?Ut():U(()=>!!(t.posts&&t.posts.length>0))()?(()=>{var x=zt(),w=x.firstChild;w.firstChild;var b=w.nextSibling;return _(w,()=>t.posts.length,null),_(b,()=>t.posts.slice(0,15).map($=>(()=>{var k=Vt();return _(k,()=>$.title||`Post #${$.id}`),k})())),_(x,(()=>{var $=U(()=>t.posts.length>15);return()=>$()?(()=>{var k=Ht(),T=k.firstChild,C=T.nextSibling;return C.nextSibling,_(k,()=>t.posts.length-15,C),k})():null})(),null),x})():Kt()})()),o})():null})(),null),i})()}function ln(){const e=new Date("1987-05-10"),t=100,n=1987,[s,a]=Y({}),[i,l]=Y({}),[r,c]=Y([]),[f,u]=Y({}),[d,o]=Y({}),[p,x]=Y(typeof window<"u"?window.location.hash:""),[w,b]=Y(null),[$,k]=Y(null),T=K(()=>{const m=(p()||"").match(/^#tags\/(\d+)/);return m?parseInt(m[1],10):null}),C=K(()=>/^#tags\/new$/.test(p()||"")),I=K(()=>{const m=(p()||"").match(/^#events\/(\d+)/);return m?parseInt(m[1],10):null}),j=K(()=>/^#events\/new$/.test(p()||"")),[R,B]=Y(null),[q,F]=Y(null),[V,ee]=Y({}),[Te,se]=Y({}),[re,ie]=Y([]),[Ye,te]=Y(null),L=K(()=>{const h=[];for(let m=0;m<t;m++){const g=n+m,y=Se(new Date(g,0,4)),v=[],S=Se(new Date(g+1,0,4)),H=Math.round((+S-+y)/(7*24*60*60*1e3));for(let J=0;J<H;J++){const de=Xt(y,J*7),W=de.toLocaleString(void 0,{month:"short"}),ue=de.toISOString().slice(0,10);v.push({title:`${W} • W${J+1} • ${ue}`,start:de})}h.push({labelYear:g,firstDate:y,pad:0,weeks:v})}return h}),ae=K(()=>{const h=L(),m=[];for(let g=0,y=0;g<h.length;g+=10,y++){const v=h.slice(g,g+10);if(v.length===0)continue;let S;y===0?S="First 10 years":y===1?S="my teens":S=`my ${y}0s`,m.push({label:S,years:v})}return m}),De=K(()=>Array.from({length:52},(h,m)=>m+1));async function oe(h){if(h==null)return;const m=f();if(!m[h]){u({...m,[h]:{status:"loading",posts:[]}}),l(g=>({...g,[h]:{...g[h],posts:[],postsStatus:"loading"}}));try{const g=await fetch(`/api/tag/posts/${h}`);if(!g.ok)throw new Error("Bad response");const y=await g.json();u(v=>({...v,[h]:{status:"loaded",posts:y}})),l(v=>({...v,[h]:{...v[h],posts:y,postsStatus:"loaded"}}))}catch{u(y=>({...y,[h]:{status:"error",posts:[]}})),l(y=>({...y,[h]:{...y[h],posts:[],postsStatus:"error"}}))}}}function ne(h){const{yearMap:m,tagById:g,tagsList:y,yearSlotMap:v}=Et(h,{startDate:e,baseYearLabel:n,years:t});l(g),c(y),a(m),o(v);try{console.log("Years:",v)}catch{}}return ct(()=>{window.addEventListener("hashchange",()=>x(window.location.hash)),fetch("/api/tags").then(h=>h.json()).then(h=>{ne(h)}).catch(h=>console.error(h)),fetch("/api/events").then(h=>h.json()).then(h=>{const m=he(h||[]);console.log("events by week:",m.eventsByWeek),ee(m.eventsByWeek),se(m.eventById),ie(m.eventsList)}).catch(h=>console.error(h))}),We(()=>{T()==null&&!C()&&w()!=null&&setTimeout(()=>{const m=document.querySelector(".tag-span.edited");if(m&&typeof m.scrollIntoView=="function")try{m.scrollIntoView({block:"center",inline:"nearest",behavior:"smooth"})}catch{m.scrollIntoView(!0)}},0)}),We(()=>{if(I()==null&&!j()){const h=$();h!=null&&setTimeout(()=>{const m=document.querySelector(`.event-entry[data-id="${h}"]`);if(m&&typeof m.scrollIntoView=="function"){try{m.scrollIntoView({block:"center",inline:"nearest",behavior:"auto"})}catch{m.scrollIntoView(!0)}try{m.classList.add("edited"),setTimeout(()=>m.classList.remove("edited"),1500)}catch{}}},0)}}),U(()=>U(()=>!!(T()!=null||C()))()?(()=>{if(C()){const g=q();return O(Qe,{tag:{},onSave:y=>{l(S=>({...S,[y.id]:y}));const v=[...r().filter(S=>S.id!==y.id),y];ne(v),B(null),F(null),b(y.id),window.location.hash=""},onDelete:y=>{l(S=>{const{[y]:H,...J}=S;return J});const v=r().filter(S=>S.id!==y);ne(v),window.location.hash=""},prefill:g||{startdate:"",enddate:""}})}const h=T(),m=i()[h];return O(Qe,{tag:m,onSave:g=>{l(v=>({...v,[g.id]:g}));const y=[...r().filter(v=>v.id!==g.id),g];ne(y),b(g.id),window.location.hash=""},onDelete:g=>{l(v=>{const{[g]:S,...H}=v;return H});const y=r().filter(v=>v.id!==g);ne(y),window.location.hash=""},onBack:g=>{g!=null&&b(g)}})})():U(()=>!!(I()!=null||j()))()?(()=>{if(j())return O(Xe,{event:null,onSave:g=>{const y=[...re().filter(S=>S.id!==g.id),g],v=he(y);ee(v.eventsByWeek),se(v.eventById),ie(v.eventsList),te(null),g&&g.id!=null?k(Number(g.id)):k(null),window.location.hash=""},onDelete:g=>{const y=re().filter(S=>S.id!==g),v=he(y);ee(v.eventsByWeek),se(v.eventById),ie(v.eventsList),te(null),window.location.hash=""},get prefill(){return Ye()||void 0}});const h=I(),m=Te()[h];return O(Xe,{event:m,onSave:g=>{const y=[...re().filter(S=>S.id!==g.id),g],v=he(y);ee(v.eventsByWeek),se(v.eventById),ie(v.eventsList),te(null),g&&g.id!=null?k(Number(g.id)):k(null),window.location.hash=""},onDelete:g=>{const y=re().filter(S=>S.id!==g),v=he(y);ee(v.eventsByWeek),se(v.eventById),ie(v.eventsList),te(null),window.location.hash=""}})})():(()=>{var h=Rt();return _(h,O(Z,{get each(){return ae()},children:m=>(()=>{var g=qt(),y=g.firstChild,v=y.nextSibling;return v.firstChild,_(y,()=>m.label),_(v,O(Z,{get each(){return De()},children:S=>(()=>{var H=Gt();return z(H,"title",`Week ${S}`),_(H,S),H})()}),null),_(g,O(Z,{get each(){return m.years},children:S=>[(()=>{var H=Jt(),J=H.firstChild,de=J.nextSibling;return _(J,()=>S.labelYear),_(H,O(Z,{get each(){return S.weeks},children:W=>{const ue=()=>R()&&W.start&&R().getTime()===W.start.getTime(),Ce=(()=>{const M=W.start.getMonth();return M===11||M===0||M===1?"winter":M>=2&&M<=4?"spring":M>=5&&M<=7?"summer":"autumn"})(),cn=tt(Se(W.start)),dn=()=>(V()[cn]||[]).length>0,un=()=>{const M=R();if(!M)B(new Date(W.start));else if(M.getTime()===W.start.getTime())B(null);else{const le=M<W.start?M:W.start,Ee=M<W.start?W.start:M;F({startdate:le.toISOString().slice(0,10),enddate:Ee.toISOString().slice(0,10)}),B(null),window.location.hash="#tags/new"}},fn=()=>{te({date:W.start.toISOString().slice(0,10)}),window.location.hash="#events/new"};return(()=>{var M=Qt();return M.$$dblclick=fn,M.$$click=un,E(le=>{var Ee=Le("week-box",`season-${Ce}`,{selected:ue(),filled:dn(),"before-my-time":W.start.getTime()<new Date("1987-05-10").getTime(),future:W.start.getTime()>new Date().getTime()}),rt=W.title;return Ee!==le.e&&Me(M,le.e=Ee),rt!==le.t&&z(M,"title",le.t=rt),le},{e:void 0,t:void 0}),M})()}}),de),E(W=>{var ue=`Year ${S.labelYear} — starting ${Zt(S.firstDate)}`,Ce=st(S.labelYear,n,t);return ue!==W.e&&z(H,"aria-label",W.e=ue),Ce!==W.t&&Ge(de,"background",W.t=Ce),W},{e:void 0,t:void 0}),H})(),O(rn,{get weeks(){return S.weeks},getEventsByWeek:V,getLastEditedEventId:$}),O(an,{get labelYear(){return S.labelYear},get pad(){return S.pad},get lanes(){return d()[S.labelYear]||[]},lastEditedTagId:w,tagById:i,ensureTagPosts:oe,years:t,baseYearLabel:n})]}),null),E(()=>z(g,"aria-label",m.label)),g})()})),h})())}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("weeks");e&&wt(()=>O(ln,{}),e)}),Be(["click","dblclick"])})();
//# sourceMappingURL=weeks.js.map
